disney_raw <- read.csv("disney_plus_titles.csv")
View(disney_raw)
pacman::p_load(data.table, dplyr, readr, qs, stringr, tidyr,
googlesheets4, ggplot2, lubridate, reshape2, openxlsx, scales, googledrive, zoo,
forecast)
View(head(disney_raw))
disney_raw %>%
select(distinct(country)) %>%
tally()
disney_raw %>%
distinct(country) %>%
tally()
disney_raw %>%
country %>%
tally()
disney_raw %>%
select(country) %>%
tally()
disney_raw %>%
distinct(country)
disney_raw %>%
select(title)
disney_raw %>%
distinct(title)
source("~/.active-rstudio-document", echo=TRUE)
disney_raw %>%
distinct(title) %>%
tally()
disney <- disney_raw %>%
mutate(month_added = month(date_added))
disney <- disney_raw %>%
mutate(month_added = month(date_added, format = "%B %d, %Y"))
disney <- disney_raw %>%
mutate(month_added = month(as.Date(date_added, format = "%B %d, %Y")))
View(disney_raw)
View(disney)
disney <- disney_raw %>%
mutate(month_added = ym(as.Date(date_added, format = "%B %d, %Y")))
disney <- disney_raw %>%
mutate(month_added = ym(as.Date(date_added, format = "%B %d, %Y")))
disney <- disney_raw %>%
mutate(month_added = ymd(as.Date(date_added, format = "%B %d, %Y")))
disney <- disney_raw %>%
mutate(date_added = ymd(as.Date(date_added, format = "%B %d, %Y")))
disney <- disney_raw %>%
mutate(date_added = ymd(as.Date(date_added, format = "%B %d, %Y")),
year_mon = ym(date_added))
disney <- disney_raw %>%
mutate(date_added = ymd(as.Date(date_added, format = "%B %d, %Y")),
year_mon = yearmon(date_added))
type_tally <- disney %>%
group_by(type) %>%
tally()
View(type_tally)
type_tally <- disney %>%
group_by(type) %>%
summarise(month = yearmon(date_added)) %>%
tally()
type_tally <- disney %>%
group_by(type) %>%
summarise(month = yearmon(date_added))
type_tally <- disney %>%
group_by(type) %>%
summarise(month = format(date_added, "%Y-%m"))
View(type_tally)
type_tally <- disney %>%
group_by(type) %>%
summarise(month = tally(format(date_added, "%Y-%m")))
type_tally <- disney %>%
group_by(type) %>%
summarise(month = count(format(date_added, "%Y-%m")))
type_tally <- disney %>%
group_by(type) %>%
summarise(month = format(date_added, "%Y-%m"))
type_tally <- disney %>%
group_by(type) %>%
summarise(month = format(date_added, "%Y-%m")) %>%
tally()
View(type_tally)
type_tally <- disney %>%
group_by(type) %>%
summarise(month = format(date_added, "%Y-%m")) %>%
tally(month)
type_tally <- disney %>%
count(type)
View(type_tally)
disney <- disney_raw %>%
mutate(date_added = ymd(as.Date(date_added, format = "%B %d, %Y")),
month_added = format(date_added, "%Y-%m"))
type_tally <- disney %>%
aggregate(month_added ~ type, count)
type_tally <- disney %>%
aggregate(type ~ month_added, count)
type_tally <- disney %>%
aggregate(type ~ month_added, sum)
?aggregate
type_tally <- disney %>%
aggregate(type ~ month_added, data = disney, sum)
type_tally <- disney %>%
aggregate(type ~ month_added, tally)
aggregate(type ~ month_added, data = disney, count)
aggregate(type ~ month_added, data = disney, str_count)
type_tally <- aggregate(type ~ month_added, data = disney, str_count)
View(type_tally)
type_tally <- disney %>%
group_by(type, month_added) %>%
summarise(count = n())
View(type_tally)
type_tally <- disney %>%
group_by(type, month_added) %>%
summarise(count = n()) %>%
arrange(month_added, desc(count))
View(type_tally)
type_tally %>%
ggplot(aes(x = month_added, y=count), fill = type) + geom_col
type_tally %>%
ggplot(aes(x = month_added, y=count), fill = type) + geom_col()
type_tally %>%
ggplot(aes(x = month_added, y=count), fill = type) + geom_line()
type_tally %>%
filter(month_added != NA) %>%
ggplot(aes(x = month_added, y=count), fill = type) + geom_line()
type_tally %>%
filter(month_added != NA) %>%
ggplot(aes(x = month_added, y=count), fill = type) + geom_line()
type_tally %>%
filter(month_added != "NA") %>%
ggplot(aes(x = month_added, y=count), fill = type) + geom_line()
type_tally %>%
filter(month_added != "NA") %>%
ggplot(aes(x = month_added, y=count), fill = type) + geom_count()
type_tally %>%
filter(month_added != "NA") %>%
ggplot(aes(x = month_added, y=count), fill = type) + geom_col()
type_tally %>%
filter(month_added != "NA") %>%
ggplot(aes(x = month_added, y=count, fill=type)) + geom_col()
type_tally %>%
filter(month_added != "NA") %>%
ggplot(aes(x = month_added, y=count, fill=type)) + geom_col() %>%
arrange(month_added)
type_tally %>%
filter(month_added != "NA") %>%
ggplot(aes(x = month_added, y=count, fill=type)) + geom_col() %>%
theme(axis.text.x = element_text(angle = 90, hjust = 1))
type_tally %>%
filter(month_added != "NA") %>%
ggplot(aes(x = month_added, y=count, fill=type)) + geom_col() %>%
theme(axis.text.x = element_text(angle = 90, hjust = 1))
type_tally %>%
filter(month_added != "NA") %>%
ggplot(aes(x = month_added, y=count, fill=type)) + geom_col()
type_tally %>%
filter(month_added != "NA") %>%
ggplot(aes(x = month_added, y=count, fill=type)) + geom_col() +
scale_x_discrete(guide = guide_axis(n.dodge=3))
type_tally %>%
filter(month_added != "NA") %>%
ggplot(aes(x = month_added, y=count, fill=type)) + geom_col() +
theme(axis.text.x = element_text(angle = 45))
type_tally %>%
filter(month_added != "NA") %>%
ggplot(aes(x = month_added, y=count, fill=type)) + geom_col() +
theme(axis.text.x = element_text(angle = 90))
type_tally %>%
filter(month_added != "NA") %>%
ggplot(aes(x = month_added, y=count, fill=type)) + geom_line() +
theme(axis.text.x = element_text(angle = 90))
type_tally %>%
filter(month_added != "NA") %>%
ggplot(aes(x = month_added, y=count, fill=type)) + geom_col() +
theme(axis.text.x = element_text(angle = 90))
type_tally %>%
filter(month_added != "NA" & month_added >= "2020-01") %>%
ggplot(aes(x = month_added, y=count, fill=type)) + geom_col() +
theme(axis.text.x = element_text(angle = 90))
type_tally %>%
filter(month_added != "NA" & month_added >= "2020-01") %>%
ggplot(aes(x = month_added, y=count, fill=type)) + geom_col() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Year-Month", y = "Count of Titles", title = "TV Shows and Movies Added on Disney+")
type_tally %>%
filter(month_added != "NA" & month_added >= "2020-01") %>%
ggplot(aes(x = month_added, y=count, fill=type)) + geom_col() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Year-Month", y = "Count of Titles", title = "Number of TV Shows and Movies Added on Disney+")
type_tally %>%
filter(month_added != "NA" & month_added >= "2020-01") %>%
ggplot(aes(x = month_added, y=count, fill=type)) + geom_col() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Year-Month", y = "Count of Titles", title = "Number of TV Shows and Movies Added on Disney+") +
scale_x_date(breaks = "1 month")
type_tally %>%
filter(month_added != "NA" & month_added >= "2020-01") %>%
ggplot(aes(x = month_added, y=count, fill=type)) + geom_col() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Year-Month", y = "Count of Titles", title = "Number of TV Shows and Movies Added on Disney+")
type_tally %>%
filter(month_added != "NA" & month_added >= "2020-01") %>%
ggplot(aes(x = month_added, y=count, color=type)) + geom_col() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Year-Month", y = "Count of Titles", title = "Number of TV Shows and Movies Added on Disney+")
type_tally %>%
filter(month_added != "NA" & month_added >= "2020-01") %>%
ggplot(aes(x = month_added, y=count, color=type)) + geom_line() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Year-Month", y = "Count of Titles", title = "Number of TV Shows and Movies Added on Disney+")
View(type_tally)
disney %>%
filter(month_added != "NA" & month_added >= "2020-01") %>%
ggplot(aes(x = month_added, y=count, color=type)) + geom_line() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Year-Month", y = "Count of Titles", title = "Number of TV Shows and Movies Added on Disney+")
type_tally %>%
filter(month_added != "NA" & month_added >= "2020-01") %>%
ggplot(aes(x = month_added, y=count, color=type)) + geom_line() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Year-Month", y = "Count of Titles", title = "Number of TV Shows and Movies Added on Disney+")
type_tally %>%
filter(month_added != "NA" & month_added >= "2020-01") %>%
ggplot(aes(x = month_added, y=count, color=type, group = 1)) + geom_line() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Year-Month", y = "Count of Titles", title = "Number of TV Shows and Movies Added on Disney+")
type_tally %>%
filter(month_added != "NA" & month_added >= "2020-01") %>%
ggplot(aes(x = month_added, y=count, color=type, group = 2)) + geom_line() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Year-Month", y = "Count of Titles", title = "Number of TV Shows and Movies Added on Disney+")
type_tally %>%
filter(month_added != "NA" & month_added >= "2020-01") %>%
ggplot(aes(x = month_added, y=count, color=type, group = 4)) + geom_line() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Year-Month", y = "Count of Titles", title = "Number of TV Shows and Movies Added on Disney+")
type_tally %>%
filter(month_added != "NA" & month_added >= "2020-01") %>%
ggplot(aes(x = month_added, y=count, color=type, group = 1)) + geom_line() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Year-Month", y = "Count of Titles", title = "Number of TV Shows and Movies Added on Disney+")
type_tally %>%
filter(month_added != "NA" & month_added >= "2020-01") %>%
ggplot(aes(x = month_added, y=count, color=type, group = type)) + geom_line() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Year-Month", y = "Count of Titles", title = "Number of TV Shows and Movies Added on Disney+")
# visual of occurences by type
# movies seem to have the edge throughout the pandemic months
type_tally %>%
filter(month_added != "NA") %>%
ggplot(aes(x = month_added, y=count, color=type, group = type)) + geom_line() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Year-Month", y = "Count of Titles", title = "Number of TV Shows and Movies Added on Disney+")
# visual of occurences by type
# movies seem to have the edge throughout the pandemic months
type_tally %>%
filter(month_added != "NA" & month_added >= "2020-01") %>%
ggplot(aes(x = month_added, y=count, color=type, group = type)) + geom_line() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Year-Month", y = "Count of Titles", title = "Number of TV Shows and Movies Added on Disney+")
# occurrences by type and month/day
type_tally <- disney %>%
group_by(type, month_added) %>%
filter(month_added != "NA") %>%
summarise(count = n()) %>%
arrange(month_added, desc(count))
# Does Disney+ has more focus on TV Shows than movies in recent years?
# visual of occurrences by type
# movies seem to have the edge throughout the pandemic months
# filtered out when it first got released in 2019 due to large added titles
type_tally %>%
filter(month_added != "NA" & month_added >= "2020-01") %>%
ggplot(aes(x = month_added, y=count, color=type, group = type)) + geom_line() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Year-Month", y = "Count of Titles", title = "Number of TV Shows and Movies Added on Disney+")
# Does Disney+ has more focus on TV Shows than movies in recent years?
# visual of occurrences by type
# movies seem to have the edge throughout the pandemic months
# filtered out when it first got released in 2019 due to large added titles
type_tally %>%
filter(month_added != "NA" & month_added >= "2020-01") %>%
ggplot(aes(x = month_added, y=count, color=type, group = type)) + geom_smooth() +
theme(axis.text.x = element_text(angle = 90)) +
labs(x = "Year-Month", y = "Count of Titles", title = "Number of TV Shows and Movies Added on Disney+")
country_availability <- disney %>%
filter(grepl("United States", country)) %>%
tally()
View(country_availability)
country_availability <- disney %>%
filter(grepl("United States", country))
View(country_availability)
country_availability <- disney %>%
filter(!grepl("United States", country)) %>%
country_availability <- disney %>%
filter(!grepl("United States", country))
country_availability <- disney %>%
filter(!grepl("United States", country))
View(country_availability)
country_availability <- disney %>%
filter(!grepl("United States", country) & !grepl("", country))
country_availability <- disney %>%
filter(!grepl("United States", country) | !grepl("", country))
View(country_availability)
disney %>%
select(country) %>%
filter(show_id == 1)
disney %>%
select(show_id, country) %>%
filter(show_id == 1)
disney %>%
select(show_id, country) %>%
filter(show_id == "s1")
country_availability <- disney %>%
filter(!grepl("United States", country) | !grepl(" ", country))
country_availability <- disney %>%
filter(!grepl("United States", country) | !grepl("", country))
country_availability <- disney %>%
filter(grepl("United Kingdom", country) | !grepl("", country))
View(country_availability)
country_availability <- disney %>%
filter(grepl("South Korea", country) | !grepl("", country))
country_availability <- disney %>%
filter(grepl("France", country) | !grepl("", country))
country_availability <- disney %>%
filter(grepl("Australia", country) | !grepl("", country))
country_availability <- disney %>%
filter(grepl("Canada", country) | !grepl("", country))
country_availability <- disney %>%
filter(grepl("Mexico", country) | !grepl("", country))
country_availability <- disney %>%
filter(grepl("Germany", country) | !grepl("", country))
countries <- c("United States", "United Kingdom", "Austrailia", "Germany", "France",
"South Korea", "Japan", "Canada", "Mexico")
map_df(countries,
~ disney %>%
filter(grepl(.x, text, ignore.case=TRUE)) %>%
count(),
.id="Country")
pacman::p_load(data.table, qs, stringr, tidyverse, googlesheets4, ggplot2,
lubridate, reshape2, openxlsx, scales, googledrive, zoo,
forecast)
map_df(countries,
~ disney %>%
filter(grepl(.x, text, ignore.case=TRUE)) %>%
count(),
.id="Country")
map_df(countries,
~ disney %>%
filter(grepl(.x, country, ignore.case=TRUE)) %>%
count(),
.id="Country")
countries <- c("United States"="United States", "United Kingdom", "Austrailia", "Germany", "France",
"South Korea", "Japan", "Canada", "Mexico")
# mapping of each country and how many titles are offered on disney
# currently displays indicies, will need to change to labels
map_df(countries,
~ disney %>%
filter(grepl(.x, country, ignore.case=TRUE)) %>%
count(),
.id="Country")
countries <- c(United States="United States", "United Kingdom", "Austrailia", "Germany", "France",
"South Korea", "Japan", "Canada", "Mexico")
countries <- c(United_States ="United States", "United Kingdom", "Austrailia", "Germany", "France",
"South Korea", "Japan", "Canada", "Mexico")
# mapping of each country and how many titles are offered on disney
# currently displays indicies, will need to change to labels
map_df(countries,
~ disney %>%
filter(grepl(.x, country, ignore.case=TRUE)) %>%
count(),
.id="Country")
countries <- c("United States", "United Kingdom", "Austrailia", "Germany", "France",
"South Korea", "Japan", "Canada", "Mexico")
# mapping of each country and how many titles are offered on disney
# currently displays indicies, will need to change to labels
map_df(countries,
~ disney %>%
filter(grepl(.x, country, ignore.case=TRUE)) %>%
count(),
.id="Country")
